<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Introducing RegRippy - SixFoisNeuf</title><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:title" content="Introducing RegRippy"><meta property="og:description" content="This post was written as part of my work as a member of the Airbus CERT. Anectodes and opinions shared in this post only reflect my own beliefs and not necessarily my teammates’ or my employer’s.
When investigating an intrusion on a system, the Windows registry can be a treasure mine of information. From quick wins like grabbing the machine’s name or recent documents to more advanced techniques like parsing shellbags, you can get some very deep insight on what a machine was used for."><meta property="og:type" content="article"><meta property="og:url" content="https://sixfoisneuf.fr/posts/introducing-regrippy/"><meta property="article:published_time" content="2019-04-19T09:32:12+00:00"><meta property="article:modified_time" content="2019-04-19T09:32:12+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Introducing RegRippy"><meta name=twitter:description content="This post was written as part of my work as a member of the Airbus CERT. Anectodes and opinions shared in this post only reflect my own beliefs and not necessarily my teammates’ or my employer’s.
When investigating an intrusion on a system, the Windows registry can be a treasure mine of information. From quick wins like grabbing the machine’s name or recent documents to more advanced techniques like parsing shellbags, you can get some very deep insight on what a machine was used for."><link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel=stylesheet><link rel=stylesheet type=text/css media=screen href=https://sixfoisneuf.fr/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://sixfoisneuf.fr/css/main.css><script src=https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js></script><script src=https://sixfoisneuf.fr/js/main.js></script></head><body><div class="container wrapper post"><div class=header><base href=https://sixfoisneuf.fr/><h1 class=site-title><a href=https://sixfoisneuf.fr/>SixFoisNeuf</a></h1><div class=site-description><h2>Systems administration, DFIR and malware analysis</h2><nav class="nav social"><ul class=flat><a href=https://twitter.com/simsor title=Twitter><i data-feather=twitter></i></a><a href=https://github.com/simsor title=GitHub><i data-feather=github></i></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>Home</a></li><li><a href=/about>About me</a></li><li><a href=/posts/index.xml>RSS</a></li></ul></nav></div><div class=post-header><h1 class=title>Introducing RegRippy</h1><div class=meta>Posted at &mdash; Apr 19, 2019</div></div><div class=markdown><p><em>This post was written as part of my work as a member of the <a href=https://www.trusted-introducer.org/directory/teams/ai-cert.html>Airbus CERT</a>. Anectodes and opinions shared in this post only reflect my own beliefs and not necessarily my teammates’ or my employer’s.</em></p><p>When investigating an intrusion on a system, the Windows registry can be a treasure mine of information. From quick wins like grabbing the machine’s name or recent documents to more advanced techniques like parsing <a href=http://www.williballenthin.com/forensics/shellbags/index.html>shellbags</a>, you can get some very deep insight on what a machine was used for. The only trouble is to know where to look.</p><h2 id=the-past>The past</h2><p>When performing DFIR, I regularly used <a href=https://github.com/keydet89/RegRipper2.8>Regripper</a>, which is a collection of Perl scripts to extract various information from registry <a href=https://docs.microsoft.com/en-us/windows/desktop/sysinfo/registry-hives>hives</a>. It worked decently enough, but there was a kind of unwieldy feeling to it. First of all, the <code>rip.pl</code> script wasn’t really happy to be called from anywhere other than its project folder. Wrapping it up in a shell script to fix it meant I had to provide the absolute path to the hive I wanted to analyze. Finally, it being written in Perl meant that I wasn’t confortable at all writing my own plugins for it.</p><p>All these seemingly small problems, when added together, meant that I was ready to move to an alternative. The only problem was, what alternative? Indeed, most registry analysis scripts were one-offs meant to grab a specific information from a hive, nothing else. There was no unified output between the tools, and each one used its own library or techniques to access the data it needed. That’s when I decided I needed to <a href=https://xkcd.com/927/>write something myself</a>.</p><h2 id=regrippy---hopefully-a-better-solution-r>RegRippy - hopefully a better solution (r)</h2><p><a href=https://github.com/airbus-cert/regrippy>RegRippy</a> is a collection of scripts as well as a framework to quickly extract data from Windows registry hives. It is written in Python 3 and uses William Ballenthin’s excellent <a href=https://github.com/williballenthin/python-registry>python-registry</a> library to do most of the heavy lifting. It has lots of quality-of-life improvements over regripper, for example:</p><ul><li>Automatically pass the right hive to a plugin depending on which one it needs</li><li>Read hives’ path from environment variables (<code>export</code> them once and there you go!)</li><li>Find hives automatically if you pass the root directory of your disk</li><li>Execute a plugin on every user hive (<code>NTUSER.DAT</code> or <code>UsrClass.dat</code>)</li><li>Bodyfile format when piping through other commands</li><li>And more!</li></ul><p>I’ve also taken the time to fix all pet peeves I had with regripper, like the useless message when you ran a plugin or the problems regarding the <code>plugins</code> folder. RegRippy results are straight and to the point (most of the time). If you love timelining, you’re in luck! All plugins are also required to support a « machine-readable » output, which here means <code>Bodyfile</code> format! Pipe it straight into <code>mactime</code> and enjoy.</p><p>Here’s a sample session:</p><pre><code>$ pip3 install regrippy
$ cd /mnt/c
$ reg_compname --root .
SIMON-LAPTOP
$
</code></pre></div><div class=post-tags></div></div><div class="footer wrapper"><nav class=nav><div><a href=https://github.com/vividvilla/ezhil>Ezhil theme</a> | Built with <a href=https://gohugo.io>Hugo</a></div></nav></div><script>feather.replace()</script></body></html>